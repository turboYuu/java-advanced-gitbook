> 第五部分 Zookeeper深入进阶

# 1 ZAB 协议

## 1.1 概念

zookeeper 并没有完全采用 paxos 算法，而是使用了一种称为 Zookeeper Atomic Broadcast（ZAB，Zookeeper 原子消息广播协议）的协议作为其数据一致性的核心算法。

ZAB 协议并不像 Paxos 算法那样是一种通用的分布式一致性算法，它是一种特别为 zookeeper 专门设计的一种**支持崩溃恢复的原子广播协议**

在 Zookeeper 中，主要就是依赖 ZAB 协议来实现分布式数据的一致性，基于该协议，Zookeeper 实现了一种主备模式的系统架构来保持集群中各副本之间数据的一致性，表现形式就是 使用一个单一的主进程来接收并处理客户端的所有事务请求，并采用ZAB 的原子广播协议，将服务器数据的状态变更以事务 Proposal 的形式广播到所有的副本进程中，ZAB 协议的主备模型架构保证了同一时刻集群中只能够有一个主进程来广播服务器的状态变更，

## 1.2 ZAB 核心

## 1.3 ZAB 介绍

## 1.4 运行时状态分析

## 1.5 ZAB 与 Paxos 的联系和区别

# 2 服务器角色

## 2.1 Leader

## 2.2 Follower

## 2.3 Observer

# 3 服务器启动

## 3.1 服务端整体架构图

## 3.2 单机版服务器启动

## 3.3 集群服务器启动

# 4 Leader选举

## 4.1 服务器启动时期的 Leader 选举

## 4.2 服务器运行时期的 Leader 选举