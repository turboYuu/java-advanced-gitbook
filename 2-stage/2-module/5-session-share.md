> 第五部分 Session共享问题

Session 共享及 Session  保持或者叫做 Session 一致性

![image-20220711153605001](assest/image-20220711153605001.png)

# 1 Session 问题原因分析

出现这个问题的原因，从根本上来说是因为 Http 协议是无状态的协议。客户端和服务端在某次会话中产生的数据不会保留下来，所以第二次请求服务端无法认识到你曾经来过，Http 为什么要设计为无状态协议？早期都是静态页面无所谓有无状态，后面有动态的内容更丰富，就需要有状态，出现了两种用于保持 Http 状态的技术，那就是 Cookie 和 Session，而出现上述不停让登录的问题，分析如下图：

场景：nginx 默认轮询策略

![image-20220711165133144](assest/image-20220711165133144.png)

> 问题；两次登录重定向之后，8080 和 8081 都会保存 session 数据，为什么还会被拦截重定向到登录页面？
>
> 

# 2 解决 Session 一致性的方案

## 2.1 Nginx 的 IP_HASH 策略（可以使用）

同一个客户端IP的请求都会被路由到同一个目标服务器，也叫做会话粘滞



## 2.2 Session 复制（不推荐）



## 2.3 Session 共享，Seesion 集中存储（推荐）









































